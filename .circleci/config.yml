version: 2
jobs:
  build:
    docker:
      - image: cirrusci/flutter
    steps:
      - checkout

      - run: 
          name: Check flutter status
          command: flutter doctor

      - run:
          name: Install JUnitReport
          command: pub global activate junitreport

      - run:
          name: Create test-results in tmp
          command: mkdir --parents /tmp/test-results/flutter

      - run:
          name: DEBUG Flutter Path
          command: ls -la $HOME/.pub-cache/bin

      - run:
          name: Run Flutter tests.
          command: flutter test --machine | $HOME/.pub-cache/bin/tojunit > /tmp/test-results/flutter/TEST-report.xml
